"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getObjectId = void 0;
const graphql_relay_1 = require("graphql-relay");
const mongoose_1 = require("mongoose");
// returns an ObjectId given an param of unknown type
const getObjectId = (target) => {
    if (target instanceof mongoose_1.Types.ObjectId) {
        return new mongoose_1.Types.ObjectId(target.toString());
    }
    if (typeof target === 'object' && target instanceof mongoose_1.Document) {
        return target && target._id ? new mongoose_1.Types.ObjectId(target._id) : null;
    }
    if (mongoose_1.Types.ObjectId.isValid(target)) {
        return new mongoose_1.Types.ObjectId(target.toString());
    }
    if (typeof target === 'string') {
        const result = (0, graphql_relay_1.fromGlobalId)(target);
        if (result.type && result.id && mongoose_1.Types.ObjectId.isValid(result.id)) {
            return new mongoose_1.Types.ObjectId(result.id);
        }
        if (mongoose_1.Types.ObjectId.isValid(target)) {
            return new mongoose_1.Types.ObjectId(target);
        }
        return null;
    }
    return null;
};
exports.getObjectId = getObjectId;
//# sourceMappingURL=getObjectId.js.map